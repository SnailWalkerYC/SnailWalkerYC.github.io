---
layout: post
title: ffmpeg Cookbook
date: 2019-07-24
Author: 来自中世界
categories: [technology]
tags: [ffmpeg]
comments: false
---

- change video speed 
> ffmpeg -i input.mkv -filter:v "setpts=0.5*PTS" output.mkv
> ffmpeg -i input.mkv -r 16 -filter:v "setpts=0.25*PTS" output.mkv
> fmpeg -i input.mkv -filter:v "setpts=2.0*PTS" output.mkv
> ffmpeg -i input.mkv -filter "minterpolate='mi_mode=mci:mc_mode=aobmc:vsbmc=1:fps=120'" output.mkv
> ffmpeg -i input.mkv -filter:a "atempo=2.0" -vn output.mkv

- change video resolution
> ffmpeg -i video_1920.mp4 -vf scale=640:360 video_640.mp4 -hide_banner
> ffmpeg -i input.mp4 -s 1280x720 -c:a copy output.mp4

- cut video from definite time and time duration
> ffmpeg -i movie.mp4 -ss 00:00:03 -t 00:00:08 -async 1 cut.mp4
> ffmpeg -i input.mp4 -ss 00:01:00 -to 00:02:00 -c copy output.mp4
> ffmpeg -i input.mp4  -t 50 output.avi

- change video format
> ffmpeg -i infile.avi youroutput.mp4
> ffmpeg -i input.avi -strict -2 output.mp4
> ffmpeg -i video.flv video.mpeg
> ffmpeg -i input.webm -qscale 0 output.mp4

- display video information
> ffmpeg -i video.mp4
> ffmpeg -i video.mp4 -hide_banner

- see supporting format
> ffmpeg -formats

- change video to audio
> ffmpeg -i input.mp4 -vn -ab 320 output.mp3
> ffmpeg -i input.mp4 -vn -ar 44100 -ac 2 -ab 320 -f mp3 output.mp3

- compressing video and audio
> ffmpeg -i input.mp4 -vf scale=1280:-1 -c:v libx264 -preset veryslow -crf 24 output.mp4
-ac 2 -c:a aac -strict -2 -b:a 128k
> ffmpeg -i input.mp3 -ab 128 output.mp3

- remove audio stream
> ffmpeg -i input.mp4 -an output.mp4

- remove video stream
> ffmpeg -i input.mp4 -vn output.mp3
> ffmpeg -i input.mp4 -vn -ab 320 output.mp3

- change video to image
> ffmpeg -i input.mp4 -r 1 -f image2 image-%2d.png

- cropping video
> ffmpeg -i input.mp4 -croptop 100 -cropbottom 100 -cropleft 300 -cropright 300 output.mp4

- change aspect ratio of video
> ffmpeg -i input.mp4 -aspect 16:9 output.mp4

- adding poster image
> ffmpeg -loop 1 -i inputimage.jpg -i inputaudio.mp3 -c:v libx264 -c:a aac -strict experimental -b:a 192k -shortest output.mp4

- trim the media file with start and stop time
> ffmpeg -i input.mp4 -ss 00:00:50 -codec copy -t 50 output.mp4

- split video into multiple parts
> ffmpeg -i input.mp4 -t 00:00:30 -c copy part1.mp4 -ss 00:00:30 -codec copy part2.mp4

- join video together
# create joining file
/home/sk/myvideos/part1.mp4
/home/sk/myvideos/part2.mp4
/home/sk/myvideos/part3.mp4
/home/sk/myvideos/part4.mp4
> ffmpeg -f concat -i join.txt -c copy output.mp4

- add sub-title
> fmpeg -i input.mp4 -i subtitle.srt -map 0 -map 1 -c copy -c:v libx264 -crf 23 -preset veryfast output.mp4 

- play video and audio or preview
> ffplay video.mp4
> ffplay audio.mp3

- get help
> man ffmpeg

- increasing/decreasing speed
> ffmpeg -i inputvideo.mp4 -vf "setpts=0.5*PTS" outputvideo.mp4
> ffmpeg -i inputvideo.mp4 -vf "setpts=4.0*PTS" outputvideo.mp4

Reference:
> https://www.bugcodemaster.com/article/changing-resolution-video-using-ffmpeg
> https://unix.stackexchange.com/questions/35746/encode-with-ffmpeg-using-avi-to-mp4
> https://ffmpeg.org/ffmpeg.html
> https://www.ostechnix.com/20-ffmpeg-commands-beginners/
> https://www.ffmpeg.org/ffmpeg.html
> Video speed: http://trac.ffmpeg.org/wiki/How to speed up / slow down a video
